#!/bin/env bash
menu=( \ 
    books \
    email \
    firefox \
    chromium \
    dev_firefox \
    mixes \
    obsidian \
    soundcards \
    tracks \
    wifi \
    wireshark \
    fireshark \
    brightness \
    libreoffice \
    bassdrive \
)

choice=$(for c in "${menu[@]}"; do printf "%s\n" $c; done | sort -u | fzf --color=bw --info=hidden --pointer=" ")
if [ $? = 0 ]; then
    case "$choice" in
        books)
            DIR=$HOME/files/books
            FILE="$DIR/"$(cd $DIR && find . -maxdepth 1 -type f | fzf --color=bw --info=hidden --pointer=" ")
            if [ -f "$FILE" ]; then
                setsid swaymsg -t command exec "zathura $FILE";
            fi
            ;;
        mixes)
            DIR=$HOME/files/music/mixes
            FILE="$DIR/"$(cd $DIR && find . -type f | fzf --color=bw --info=hidden --pointer=" ")
            mpv --no-video $FILE
            ;;
        bassdrive)
            mpv 'http://bassdrive.com/bassdrive.m3u'
            ;;
        soundcards)
            cat /proc/asound/modules
            read -n 1 -p ...
            ;;
        tracks)
            mpv --shuffle --no-video $HOME/files/music/tracks/{2020,2021}
            ;;
        wifi)
            iwctl
            ;;
        email)
            setsid swaymsg -t command exec "evolution"
            ;;
        wireshark)
            setsid swaymsg -t command exec "wireshark"
            ;;
        firefox)
            setsid swaymsg -t command exec "firefox"
            ;;
        dev_firefox)
            setsid swaymsg -t command exec "$HOME/opt/firefox/firefox"
            ;;
        fireshark)
            setsid swaymsg -t command exec \
                'env SSLKEYLOGFILE="$HOME/log/firefox/ssl_key" $HOME/opt/firefox/firefox 2>&1 > "$HOME/log/firefox.log"'
            setsid swaymsg -t command exec "SSLKEYLOGFILE='$HOME/log/firefox/ssl_key' wireshark"
            ;;
        brightness)
            sudo brightnessctl s $(cat $HOME/.brightness | fzf --info=hidden --color=bw --pointer=" ")
            ;;
        *)
            setsid swaymsg -t command exec "$choice"
            ;;
    esac
fi
